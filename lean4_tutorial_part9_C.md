# 📘 Lean4 이산수학 튜토리얼 Part 9-C: 비둘기집 원리

> **Rosen 이산수학 8판 6.2절 기반**
> **『Mathematics in Lean』 Chapter 6: Discrete Mathematics 참고**

---

## 9C.0 들어가며

지금까지 우리는 **곱셈 법칙**, **덧셈 법칙**, **뺄셈 법칙**, **나눗셈 법칙**을 배웠다. 이번에는 놀라울 정도로 단순하면서도 강력한 원리를 소개한다: **비둘기집 원리**(Pigeonhole Principle).

이 원리는 19세기 독일 수학자 **디리클레**(Dirichlet)가 자주 사용하여 **디리클레의 서랍 원리**(Dirichlet drawer principle)라고도 불린다.

---

## 9C.1 **비둘기집 원리**(Pigeonhole Principle) — 기본

### 직관적 이해

> 🐦 20마리의 비둘기가 19개의 비둘기집으로 들어간다고 하자. 비둘기는 20마리인데 비둘기집은 19개**뿐**이므로 최소한 하나 이상의 비둘기집에는 **2마리 이상**의 비둘기가 같이 있게 된다.

> 📐 **비둘기집 원리**(정리 1): k + 1개 이상의 물체를 k개의 상자에 넣는다면, 적어도 하나의 상자에는 **두 개 이상**의 물체가 들어가게 된다.

### 증명 (귀류법)

두 개 이상의 물체가 들어간 상자가 없다고 하자. 그러면 물체의 개수는 최대 k이다. 적어도 k + 1개의 물체가 있다고 하였으므로 이것은 **모순**이다. ∎

### 따름정리: 함수론적 관점

> k + 1개 또는 그 이상의 원소를 가진 집합으로부터 k개의 원소를 가진 집합으로의 함수는 **일대일 대응이 아니다**.

Lean4에서:

```lean
import Mathlib
open Finset Fintype

-- 비둘기집 원리의 함수 버전:
-- card α > card β이면, f : α → β에 대해
-- f(a₁) = f(a₂)인 서로 다른 a₁, a₂가 존재

-- 간단한 예시: 4개에서 3개로의 함수는 1대1이 아님
example : Fintype.card (Fin 4) > Fintype.card (Fin 3) := by simp
```

> 💡 **핵심**: "물체를 상자에 넣는다" = "함수 f : 물체 → 상자를 정의한다". 비둘기집 원리는 "domain이 codomain보다 크면, 이 함수는 단사(injective)가 될 수 없다"는 것이다.

---

## 9C.2 비둘기집 원리 — 기본 예제들

### **교재 예제 1**: 생일

> 367명의 사람이 있으면 적어도 두 명은 같은 생일이다. (가능한 생일: 366개)

```lean
theorem birthday_pigeonhole : 367 > 366 := by norm_num
```

### **교재 예제 2**: 영어 단어

> 영어 단어 27개를 뽑으면 적어도 두 개는 같은 문자로 시작한다. (알파벳: 26개)

```lean
theorem alphabet_pigeonhole : 27 > 26 := by norm_num
```

### **교재 예제 3**: 시험 점수

> 0~100점(101가지)의 시험에서 적어도 2명이 같은 점수를 보장하려면 **102명** 필요.

```lean
theorem exam_pigeonhole : 101 + 1 = 102 := by norm_num
```

---

## 9C.3 연습 세트 1: 기본 비둘기집 원리

### 연습 1-1: 성(last name) (교재 연습문제 2)

> **문제**: 30명의 학생이 있으면 적어도 2명의 성은 같은 영문자로 시작한다.

**[괄호 채우기]**

```lean
-- 상자 = 알파벳 26개, 물체 = 학생 30명
theorem last_name : 30 > (______) := by norm_num
```

<details>
<summary>📝 답 보기</summary>

```lean
theorem last_name : 30 > 26 := by norm_num
```
</details>

### 연습 1-2: 양말 (교재 연습문제 3a)

> **문제**: 서랍에 갈색 양말 12짝과 검은색 양말 12짝이 있다. 적어도 두 개가 같은 색인 것을 보장하려면 몇 개를 꺼내야 하는가?

**[괄호 채우기]**

```lean
-- 상자 = 색깔 2가지, k+1 = ?
theorem sock_color : 2 + 1 = (______) := by norm_num
```

<details>
<summary>📝 답 보기</summary>

```lean
theorem sock_color : 2 + 1 = 3 := by norm_num
```

풀이: 색깔 2가지(k=2)이므로 **3개** 꺼내면 보장된다.
</details>

### 연습 1-3: 십진수 배수 (교재 예제 4) — sorry 문제

> 모든 정수 n에 대해 0과 1만으로 이루어진 n의 배수가 존재한다.

```lean
-- n=3 예시: 111 = 37 × 3
theorem multiple_of_3 : 111 % 3 = 0 := by sorry
```

<details>
<summary>📝 답 보기</summary>

```lean
theorem multiple_of_3 : 111 % 3 = 0 := by norm_num
```
</details>

---

## 9C.4 **일반화된 비둘기집 원리**(Generalized Pigeonhole Principle)

### 직관적 이해

물체 수가 상자 수의 배보다 많을 때, 더 강한 결론을 얻는다.

> 📐 **일반화된 비둘기집 원리**(정리 2): N개의 물체를 k개의 상자에 넣는다면, 적어도 하나의 상자에는 **⌈N/k⌉** 개의 물체가 들어가게 된다.

⌈N/k⌉는 **올림**(ceiling)이다. 예: ⌈21/10⌉ = ⌈2.1⌉ = 3.

```lean
-- 올림 나눗셈: (N + k - 1) / k = ⌈N/k⌉

-- 예시: 21개 → 10개 상자 → ⌈21/10⌉ = 3
theorem gen_pig_21_10 : (21 + 10 - 1) / 10 = 3 := by norm_num

-- 예시: 100명 → 12개월 → ⌈100/12⌉ = 9
theorem gen_pig_100_12 : (100 + 12 - 1) / 12 = 9 := by norm_num
```

### "최소 몇 개가 필요한가?" 공식

적어도 r개가 같은 상자에 들어가는 것을 보장하려면:

> **최소 물체 수 = k(r - 1) + 1**  (k = 상자 수)

---

## 9C.5 일반화된 비둘기집 원리 — 교재 예제들

### **교재 예제 5**: 같은 달 생일

> 100명이면 적어도 ⌈100/12⌉ = **9명**은 같은 달에 태어났다.

```lean
theorem same_month : (100 + 12 - 1) / 12 = 9 := by norm_num
```

### **교재 예제 6**: 학점 (5가지 중 6명 같은 학점 보장)

> 5가지 학점, 적어도 6명이 같은 학점 → 최소 학생 수?

```lean
-- k(r-1)+1 = 5×(6-1)+1 = 26
theorem grade_pigeonhole : 5 * 5 + 1 = 26 := by norm_num
-- 25명은 부족 (각 학점 5명씩이면 6명 보장 안 됨)
```

### **교재 예제 7a**: 카드 무늬 (3장 같은 무늬 보장)

> 4가지 무늬, 3장 같은 무늬 보장 → 최소 카드 수?

```lean
-- k(r-1)+1 = 4×(3-1)+1 = 9
theorem card_suit : 4 * 2 + 1 = 9 := by norm_num
```

---

## 9C.6 연습 세트 2: 일반화된 비둘기집 원리

### 연습 2-1: 교재 연습문제 1 — 요일

> **문제**: 여섯 과목이 있으면 적어도 두 과목은 같은 요일에 있다 (주말 수업 없음).

**[괄호 채우기]**

```lean
-- 6개 과목 → 5일(월~금), 6 > 5
theorem weekday : (______) > 5 := by norm_num
```

<details>
<summary>📝 답 보기</summary>

```lean
theorem weekday : 6 > 5 := by norm_num
```
</details>

### 연습 2-2: 공 꺼내기 (교재 연습문제 4a)

> 빨간 10개, 파란 10개. 적어도 세 개가 같은 색이려면?

**[괄호 채우기]**

```lean
-- k(r-1)+1 = 2×(3-1)+1 = 5
theorem ball_3_same : 2 * 2 + 1 = (______) := by norm_num
```

<details>
<summary>📝 답 보기</summary>

```lean
theorem ball_3_same : 2 * 2 + 1 = 5 := by norm_num
```
</details>

### 연습 2-3: 전공과 학년 (교재 연습문제 5) — sorry 문제

> 4학년제, 21개 전공. 같은 학년·같은 전공이 2명 이상이려면?

```lean
-- k = 4 × 21 = 84개 상자, r = 2 → k(r-1)+1 = 85
theorem major_year : 4 * 21 + 1 = 85 := by sorry
```

<details>
<summary>📝 답 보기</summary>

```lean
theorem major_year : 4 * 21 + 1 = 85 := by norm_num
```
</details>

### 연습 2-4: 나머지 (교재 연습문제 8) — sorry 문제

> d + 1개의 정수 중 d로 나눈 나머지가 같은 수가 반드시 2개 존재한다.

```lean
theorem remainder_pigeonhole (d : Nat) (h : d > 0) : d + 1 > d := by sorry
```

<details>
<summary>📝 답 보기</summary>

```lean
theorem remainder_pigeonhole (d : Nat) (h : d > 0) : d + 1 > d := by omega
```
</details>

---

## 9C.7 비둘기집 원리의 응용

### **교재 예제 10**: 야구 경기 일정

> 한 달(30일) 동안 매일 적어도 1경기, 총 45경기 이하. 정확히 14경기를 치르는 연속된 기간이 반드시 존재함을 증명하라.

**풀이 핵심**: j번째 날까지의 누적 경기 수를 aⱼ라 하면, 60개의 수 {a₁,...,a₃₀, a₁+14,...,a₃₀+14}는 모두 1~59 사이이다. 60 > 59이므로 비둘기집 원리에 의해 aᵢ = aⱼ + 14인 쌍이 존재한다.

```lean
theorem baseball : 30 * 2 > 59 := by norm_num  -- 60 > 59
```

### **교재 예제 11**: 약수의 존재

> 2n을 넘지 않는 n+1개의 양의 정수 중에는 다른 수의 약수가 되는 정수가 반드시 존재한다.

**풀이 핵심**: 각 수를 2ᵏq로 쓰면 (q는 홀수), 홀수부 q는 n가지뿐이다. n+1개의 수에 비둘기집 원리 적용.

```lean
theorem divisor_exists (n : Nat) (h : n > 0) : n + 1 > n := by omega
```

---

## 9C.8 **단조 부수열 정리** (에르되시-세게디)

비둘기집 원리의 가장 아름다운 응용 중 하나다.

> 📐 **정리 3**: n² + 1개의 서로 다른 실수로 구성된 모든 수열은 길이 n + 1의 단조 증가 또는 단조 감소 **부수열**(subsequence)을 포함한다.

용어 정리:
- **부수열** = 원래 수열에서 순서를 유지하며 일부 항을 선택한 수열
- **단조 증가** = 각 항이 그 전 항보다 큰 경우
- **단조 감소** = 각 항이 그 전 항보다 작은 경우

### 교재 예제 12

> 수열 8, 11, 9, 1, 4, 6, 12, 10, 5, 7은 10 = 3² + 1개의 항이다. 따라서 길이 4의 단조 증가 또는 감소 부수열이 존재한다:
> - 증가: 1, 4, 6, 7 / 1, 4, 6, 12 / 1, 4, 6, 10
> - 감소: 11, 9, 6, 5

```lean
theorem erdos_szekeres_ex : 3 ^ 2 + 1 = 10 := by norm_num
```

### 증명 아이디어

각 항 aₖ에 순서 쌍 (iₖ, dₖ)를 부여한다 (iₖ=가장 긴 증가 부수열 길이, dₖ=가장 긴 감소 부수열 길이). 길이 n+1의 증가/감소 부수열이 없다면 iₖ, dₖ ≤ n이므로 순서 쌍은 최대 n² 가지. 하지만 n²+1개의 항이 있으므로 비둘기집 원리에 의해 **모순**.

```lean
theorem monotone_subseq (n : Nat) : n ^ 2 + 1 > n ^ 2 := by omega
```

---

## 9C.9 **램지 이론**(Ramsey Theory) 맛보기

### **교재 예제 13**: 친구와 적

> **문제**: 여섯 명의 그룹에서 두 명의 짝을 지으면 서로 친구이거나 적이라고 가정하자. 이 그룹에는 세 명이 서로 친구이거나 세 명이 서로 적인 경우가 존재함을 증명하라.

### 풀이

여섯 사람 중 한 명을 A라 하자. 나머지 다섯 사람 중에는 A와 친구인 사람이 세 명 이상이거나 A와 적인 사람이 세 명 이상이다 (일반화된 비둘기집 원리: ⌈5/2⌉ = 3).

- A의 친구가 3명 이상인 경우: 이 3명 중 두 명이 서로 친구이면 A와 합쳐 세 명의 친구 그룹을 형성한다. 그렇지 않은 경우는 B, C, D가 서로 적인 세 명의 그룹을 형성한다.
- A의 적이 3명 이상인 경우: 같은 방법으로 증명할 수 있다.

```lean
-- 5명을 2그룹(친구/적)으로 → ⌈5/2⌉ = 3
theorem ramsey_pigeonhole : (5 + 2 - 1) / 2 = 3 := by norm_num
```

이 결과를 **램지 수**(Ramsey number)로 표현하면: R(3, 3) ≤ 6이다. 실제로 R(3, 3) = 6이다.

---

## 9C.10 연습 세트 3: 종합 문제

### 연습 3-1: 연속 정수 (교재 연습문제 9) — sorry 문제

> n개의 연속된 정수에는 n으로 나누어지는 수가 반드시 존재한다.

```lean
-- 예시: 연속 5개(7,8,9,10,11) 중 10은 5의 배수
theorem consec_div : 10 % 5 = 0 := by sorry
```

<details>
<summary>📝 답 보기</summary>

```lean
theorem consec_div : 10 % 5 = 0 := by norm_num
```
</details>

### 연습 3-2: 교재 연습문제 6 — 공동시험

> 기초 이산수학을 강의하는 6명의 교수가 서로 다른 분반을 운영하고 있다. 최저점이 0점이고 최고점이 100점이라 할 때, 동일한 분반에서 동일한 점수를 가진 학생이 2명 이상 발생되려면, 이 과목을 듣는 수강생은 얼마나 많아야 하는가?

**[sorry 문제]**

```lean
-- 상자 = 분반(6) × 점수(101) = 606가지
-- 2명 이상 → 606 + 1 = 607명
theorem exam_same_score : 6 * 101 + 1 = 607 := by sorry
```

<details>
<summary>📝 답 보기</summary>

```lean
theorem exam_same_score : 6 * 101 + 1 = 607 := by norm_num
```
</details>

### 연습 3-3: 교재 연습문제 3b — 양말 (같은 색 양면)

> 갈색 12짝, 검은색 12짝. 적어도 두 개가 검은 색의 양면인 것을 보장하려면 몇 개를 꺼내야 하는가?

**[sorry 문제]**

```lean
-- 최악: 갈색 12개 + 검은색 1개 = 13개까지 검은 1개뿐
-- 14개를 꺼내면 검은색 2개 보장
theorem black_socks : 12 + 1 + 1 = 14 := by sorry
```

<details>
<summary>📝 답 보기</summary>

```lean
theorem black_socks : 12 + 1 + 1 = 14 := by norm_num
```

풀이: 최악의 경우 갈색 양말 12개를 모두 꺼낸 후, 검은색을 1개 꺼내면 총 13개이고 검은색은 1개뿐. 14번째에 검은색이 반드시 나오므로 검은 양면(2개) 보장.
</details>

---

## 9C.11 전술 및 공식 요약

### 비둘기집 원리 핵심 공식

| 유형 | 조건 | 결론 |
|------|------|------|
| 기본 | k+1개 → k상자 | 한 상자에 **≥ 2개** |
| 일반화 | N개 → k상자 | 한 상자에 **≥ ⌈N/k⌉개** |
| 최소 보장 | r개 같은 상자 | **k(r-1)+1개** 물체 필요 |
| 에르되시-세게디 | n²+1개 서로 다른 수 | 길이 n+1 단조 부수열 |
| 램지 R(3,3) | 6명 | 3명 서로 친구 또는 3명 서로 적 |

### 문제 풀이 전략

1. **물체**(비둘기)와 **상자**(비둘기집)를 식별하라
2. 물체 수 > 상자 수인지 확인하라
3. 일반화가 필요하면 ⌈N/k⌉를 계산하라
4. "최소 몇 개?"를 묻는 문제는 **k(r-1)+1** 공식을 사용하라

---

## 9C.12 핵심 요약

1. **비둘기집 원리**: k+1개를 k개 상자에 넣으면 한 상자에 2개 이상. 단순하지만 강력하다!

2. **일반화**: N개를 k개 상자에 넣으면 한 상자에 ⌈N/k⌉개 이상.

3. **핵심 기술**: "무엇이 물체이고 무엇이 상자인지" 현명하게 선택하는 것이 관건.

4. **에르되시-세게디 정리**: n²+1개 서로 다른 수에는 길이 n+1의 단조 부수열이 존재.

5. **램지 이론**: 비둘기집 원리의 일반화로, "충분히 많은 원소가 있으면 어떤 구조가 반드시 나타난다"는 원리.

---

## 다음 편 예고

**Part 9-D**에서는 Rosen 6.3절 **순열과 조합**(Permutations and Combinations)을 다룬다:
- **순열**: P(n, r) = n!/(n-r)!
- **조합**: C(n, r) = n!/(r!(n-r)!)
- 이항 계수와 파스칼의 삼각형
