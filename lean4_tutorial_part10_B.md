# 📘 Lean 4 튜토리얼 — Part 10-B: 확률론

> **Rosen 이산수학 8판 §7.2 기반 · Mathematics in Lean 참조**
> Part 10-A에서 확률의 기초(표본공간, 라플라스의 정의, 여사건, 합사건)를 배웠다. 이제 더 정교한 확률 도구들을 알아본다.

---

## 🎯 이 파트에서 배울 것

1. **확률분포**(probability distribution) — 결과마다 확률 배정
2. **여사건과 합사건의 확률** — 일반적 정의에서 다시 증명
3. **조건부확률**(conditional probability) — "~일 때"의 확률
4. **독립사건**(independent events) — 서로 영향 없는 사건
5. **베르누이 시행**(Bernoulli trial)과 **이항분포**(binomial distribution)
6. **확률변수**(random variable)
7. **생일문제**(birthday problem)

---

## 📖 10B.1 확률분포 — 결과마다 확률을 배정하기

### 10B.1.1 왜 새로운 정의가 필요한가?

Part 10-A의 라플라스 정의(p(E) = |E|/|S|)는 **모든 결과의 발생 가능성이 동일**하다고 가정했다. 하지만 현실에서는 그렇지 않은 경우가 많다:

- 앞면이 뒷면보다 2배 더 잘 나오는 특이한 동전
- 특정 숫자가 더 잘 나오는 주사위
- 검색 엔진에서 특정 웹페이지가 더 자주 선택될 확률

이런 경우를 다루려면 각 결과에 **개별적으로 확률을 배정**하는 더 일반적인 정의가 필요하다.

### 10B.1.2 확률분포의 정의

> **표본공간**(sample space) S의 각 결과 s에 확률 p(s)를 배정할 때, 다음 두 조건이 만족되어야 한다:
>
> **(i)** 모든 s ∈ S에 대하여 **0 ≤ p(s) ≤ 1**
>
> **(ii)** **∑ₛ∈S p(s) = 1** (모든 확률의 합은 1)

이 두 조건을 만족하는 함수 p를 **확률분포**(probability distribution)라 한다.

### Lean 4에서 확률분포 표현

```lean
import Mathlib.Data.Rat.Basic
import Mathlib.Data.Finset.Basic

-- 확률분포: 표본공간의 각 원소에 ℚ 값을 배정하는 함수
-- 조건: (i) 모든 값이 0~1, (ii) 합이 1
structure ProbDist (S : Finset α) where
  prob : α → ℚ
  nonneg : ∀ s ∈ S, 0 ≤ prob s
  le_one : ∀ s ∈ S, prob s ≤ 1
  sum_one : S.sum prob = 1
```

### 10B.1.3 균등분포와 라플라스 정의의 관계

S의 원소가 n개이고, 모든 결과의 확률이 동일하면 각 확률은 1/n이다. 이것을 **균등분포**(uniform distribution)라 한다.

균등분포에서 사건 E의 확률은:

p(E) = ∑ₛ∈E p(s) = ∑ₛ∈E (1/n) = |E| × (1/n) = |E|/|S|

이것은 Part 10-A에서 배운 라플라스의 정의와 정확히 일치한다!

```lean
-- 균등분포: n개의 원소에 각각 1/n 배정
-- 예: 공정한 주사위
example : (6 : ℕ) * (1 : ℚ) / 6 = 1 := by norm_num

-- 각 면의 확률이 1/6이면 합은 1
example : (1 : ℚ)/6 + 1/6 + 1/6 + 1/6 + 1/6 + 1/6 = 1 := by norm_num
```

### 예제 1: 특이한 동전 (Rosen 예제 1)

> 동전을 던졌을 때 앞면(H)이 나올 확률과 뒷면(T)이 나올 확률을 어떻게 정해야 하는가? 만일 동전이 특이해서 앞면이 뒷면보다 2배 더 많이 나온다면?

**풀이 (일반적 동전)**: 앞면과 뒷면의 가능성이 같으므로 p(H) = p(T) = 1/2.

**풀이 (특이한 동전)**: p(H) = 2·p(T)이고, p(H) + p(T) = 1이므로:
- 2·p(T) + p(T) = 3·p(T) = 1
- p(T) = 1/3, p(H) = 2/3

```lean
-- 일반 동전
example : (1 : ℚ) / 2 + 1 / 2 = 1 := by norm_num

-- 특이한 동전: p(H) = 2p(T), p(H) + p(T) = 1
-- 3p(T) = 1 → p(T) = 1/3
example : 3 * ((1 : ℚ) / 3) = 1 := by norm_num

-- p(H) = 2/3, p(T) = 1/3
example : (2 : ℚ) / 3 + 1 / 3 = 1 := by norm_num
```

### 예제 2: 특이한 주사위 (Rosen 예제 2)

> 어떤 주사위는 3이 다른 수보다 두 배 많이 나오고, 3이 아닌 다른 수는 모두 같은 비율로 나온다. 이 주사위를 던졌을 때 홀수가 나올 확률은?

**풀이**: p(1) = p(2) = p(4) = p(5) = p(6) = 1/7, p(3) = 2/7이다. (왜냐하면 5×(1/7) + 2/7 = 7/7 = 1)

사건 E = {홀수} = {1, 3, 5}이므로:
p(E) = p(1) + p(3) + p(5) = 1/7 + 2/7 + 1/7 = 4/7

```lean
-- 각 확률의 합 = 1 확인
example : (1:ℚ)/7 + (1:ℚ)/7 + (2:ℚ)/7 + (1:ℚ)/7 + (1:ℚ)/7 + (1:ℚ)/7 = 1 := by
  norm_num

-- 홀수(1,3,5) 확률
example : (1:ℚ)/7 + 2/7 + 1/7 = 4/7 := by norm_num
```

---

## 📖 10B.2 사건의 확률 — 일반 정의

### 정의 2: 사건의 확률 (일반)

> 사건 E의 **확률**(probability)은 E에 속하는 모든 결과의 확률을 모두 더한 것이다:
>
> **p(E) = ∑ₛ∈E p(s)**

이 정의는 균등분포에서 라플라스의 정의(p(E) = |E|/|S|)와 일치하고, 비균등분포에서도 동작한다.

### 여사건과 합사건의 확률 (다시 한번)

Part 10-A의 정리 1과 정리 2는 일반 확률분포에서도 성립한다:

**p(Ē) = 1 - p(E)**: 모든 확률의 합이 1이고, 각 결과는 E 또는 Ē 중 하나에만 속하므로:
∑ₛ∈S p(s) = ∑ₛ∈E p(s) + ∑ₛ∈Ē p(s) = p(E) + p(Ē) = 1

**p(E₁ ∪ E₂) = p(E₁) + p(E₂) - p(E₁ ∩ E₂)**: 합집합에서 원소를 셀 때 겹치는 부분을 한 번 빼주는 것과 같은 원리이다.

---

## 📖 10B.3 조건부확률 — "~일 때"의 확률

### 10B.3.1 동기 부여

> 동전을 3번 던진다. 모든 경우가 동일한 확률이라고 하자. 첫 번째 던졌을 때 뒷면이 나왔다는 사실을 알고 있을 때, 뒷면이 홀수 번 나오는 사건 E의 확률은?

첫 번째 뒷면(F라 하자)이 나왔으므로 가능한 결과는:
- TTT, TTH, THT, THH (4가지)

이 중 뒷면이 홀수 번(1번 또는 3번):
- TTT (3번 뒷면 → 홀수✓), THH (1번 뒷면 → 홀수✓)

따라서 p(E | F) = 2/4 = **1/2**

### 정의 3: 조건부확률

> 사건 E와 F에 대해, **p(F) > 0**이라 하자. **F를 전제로 한 E의 조건부확률**(conditional probability) p(E | F)는:
>
> **p(E | F) = p(E ∩ F) / p(F)**

직관적 의미: F가 이미 발생했다고 알고 있을 때, 그 "축소된" 표본공간 안에서 E도 발생할 확률이다.

```lean
-- 조건부확률 함수
def condProb (pEF pF : ℚ) (hF : pF > 0) : ℚ := pEF / pF
```

### 예제 3: 비트열의 조건부확률 (Rosen 예제 3)

> 길이가 4인 비트 문자열을 임의로 생성하여 16개의 문자열이 똑같이 일어날 수 있다. 첫 번째 비트가 0이라는 전제하에 비트열에 0이 두 개 이상 연속하여 들어있을 확률은?

**풀이**:
- F = "첫 번째 비트가 0" → 0으로 시작하는 비트열 8개 → p(F) = 8/16 = 1/2
- E ∩ F = "첫 비트가 0이고 0이 두 개 이상 연속" → {0000, 0001, 0010, 0011, 0100} → p(E ∩ F) = 5/16

p(E | F) = p(E ∩ F) / p(F) = (5/16) / (1/2) = **5/8**

```lean
-- 조건부확률: p(E|F) = p(E∩F) / p(F) = (5/16) / (8/16)
example : (5 : ℚ) / 16 / (8 / 16) = 5 / 8 := by norm_num
-- 또는 더 직관적으로:
example : (5 : ℚ) / 8 = 5 / 8 := by ring
```

### 예제 4: 가정에서 아들 (Rosen 예제 4)

> 자녀가 둘인 가정에서 적어도 한 명은 아들이라고 할 때, 둘 다 아들일 조건부확률은?

**풀이**: 아들 B, 딸 G로 나타내면 BB, BG, GB, GG의 4가지 경우가 모두 같은 확률이다.
- E = {BB}, F = {BB, BG, GB}
- E ∩ F = {BB}
- p(E ∩ F) = 1/4, p(F) = 3/4
- p(E | F) = (1/4) / (3/4) = **1/3**

```lean
-- 적어도 한 명 아들일 때, 둘 다 아들일 확률
example : ((1:ℚ)/4) / ((3:ℚ)/4) = 1/3 := by norm_num
```

> 💡 많은 사람들이 직관적으로 1/2라고 생각하지만, 정확한 답은 1/3이다. 이것이 조건부확률의 미묘함이다!

---

## 📖 10B.4 독립사건 — 서로 영향 없는 사건

### 정의 4: 독립사건

> 사건 E와 F가 **독립**(independent)인 것과 다음 등식이 성립하는 것은 서로 **필요충분조건**(if and only if)이다:
>
> **p(E ∩ F) = p(E) · p(F)**

두 사건이 독립이면, 한 사건의 발생은 다른 사건이 일어날 확률에 **아무런 영향도 주지 않는다**.

> 💡 **→(if) vs ↔(if and only if) 복습** (Part 9-I 참조):
> - **→ (함의, implication)**: "A이면 B이다" — 한 방향만
> - **↔ (동치, iff)**: "A이면 B이고, B이면 A이다" — 양 방향
>
> 위 정의에서 "~인 것과 ~는 필요충분조건이다"는 ↔에 해당한다.

### 독립과 조건부확률의 관계

두 사건이 독립이면:
p(E | F) = p(E ∩ F) / p(F) = p(E)·p(F) / p(F) = p(E)

즉, F가 발생했든 안 했든 E의 확률은 변하지 않는다!

### 예제 5: 비트열의 독립성 (Rosen 예제 5)

> 임의로 생성된 길이 4인 비트열이 1로 시작하는 사건을 E, 짝수 개의 1이 들어있는 사건을 F라 하자. E와 F는 독립사건인가?

**풀이**: 16가지 비트열이 모두 같은 확률(1/16)이라 가정한다.
- E = {1로 시작} → 8가지 → p(E) = 8/16 = 1/2
- F = {짝수 개의 1} → 0000, 0011, 0101, 0110, 1001, 1010, 1100, 1111 → 8가지 → p(F) = 1/2
- E ∩ F = {1로 시작 AND 짝수 개의 1} → 1111, 1100, 1010, 1001 → 4가지 → p(E∩F) = 4/16 = 1/4

확인: p(E) · p(F) = 1/2 × 1/2 = 1/4 = p(E ∩ F) ✓

따라서 E와 F는 **독립사건**이다.

```lean
-- 독립성 확인: p(E∩F) = p(E) · p(F)
example : (1:ℚ)/4 = (1:ℚ)/2 * (1:ℚ)/2 := by norm_num
```

### 예제 6: 독립이 아닌 경우 (Rosen 예제 6)

> 자녀가 둘인 가정에서 둘 다 아들인 사건 E와 적어도 한 명이 아들인 사건 F는 독립사건인가?

**풀이**:
- E = {BB} → p(E) = 1/4
- F = {BB, BG, GB} → p(F) = 3/4
- E ∩ F = {BB} → p(E ∩ F) = 1/4

확인: p(E) · p(F) = 1/4 × 3/4 = 3/16 ≠ 1/4 = p(E ∩ F)

따라서 E와 F는 **독립사건이 아니다**.

```lean
-- 독립이 아님: p(E)·p(F) ≠ p(E∩F)
-- p(E)·p(F) = 1/4 × 3/4 = 3/16
-- p(E∩F) = 1/4 = 4/16
-- 3/16 ≠ 4/16
example : (1:ℚ)/4 * (3:ℚ)/4 ≠ (1:ℚ)/4 := by norm_num
```

---

## 📖 10B.5 베르누이 시행과 이항분포

### 10B.5.1 베르누이 시행이란?

시행 결과가 딱 두 가지(**성공** 또는 **실패**)인 경우를 **베르누이 시행**(Bernoulli trial)이라 한다.

- 동전 던지기: 앞면(성공) / 뒷면(실패)
- 제품 검사: 정상(성공) / 불량(실패)
- 소수 판별: 소수(성공) / 합성수(실패)

성공의 확률을 p, 실패의 확률을 q라 하면 **p + q = 1**이다.

### 정리 2: 이항분포

> 성공의 확률이 p이고 실패의 확률이 q = 1 - p일 때, 서로 독립인 n번의 베르누이 시행에서 정확히 k번 성공할 확률은:
>
> **C(n, k) · pᵏ · q⁽ⁿ⁻ᵏ⁾**

이 확률을 k에 관한 함수로 생각하면, 이 함수를 **이항분포**(binomial distribution)라 한다: b(k; n, p) = C(n, k) · pᵏ · q⁽ⁿ⁻ᵏ⁾

### 왜 C(n, k)가 곱해지는가?

n번의 시행 중 정확히 k번 성공하려면:
1. **어떤 시행에서 성공하는가**: n번 중 k번을 고르는 방법 = C(n, k)
2. **각 경우의 확률**: 성공 k번(pᵏ) × 실패 (n-k)번(q⁽ⁿ⁻ᵏ⁾)

### 예제 8: 특이한 동전 (Rosen 예제 8)

> 앞면이 나올 확률이 2/3인 동전이 있다. 7번 동전을 던져 앞면이 4번 나올 확률은?

**풀이**:
- n = 7, k = 4, p = 2/3, q = 1/3
- C(7, 4) · (2/3)⁴ · (1/3)³ = 35 × 16/81 × 1/27 = 35 × 16 / 2187 = 560/2187

```lean
import Mathlib.Data.Nat.Choose.Basic

-- C(7, 4) = 35
example : Nat.choose 7 4 = 35 := by native_decide

-- (2/3)^4 = 16/81
example : ((2:ℚ)/3)^4 = 16/81 := by norm_num

-- (1/3)^3 = 1/27
example : ((1:ℚ)/3)^3 = 1/27 := by norm_num

-- 최종: 35 * 16/81 * 1/27 = 560/2187
example : (35:ℚ) * (16/81) * (1/27) = 560/2187 := by norm_num
```

### 이항분포의 합은 1

모든 k에 대해 확률을 더하면:

∑ₖ₌₀ⁿ C(n,k) · pᵏ · q⁽ⁿ⁻ᵏ⁾ = (p + q)ⁿ = 1ⁿ = 1

이것은 **이항정리**(binomial theorem)의 결과이다!

---

## 📖 10B.6 확률변수

### 정의 6: 확률변수

> **확률변수**(random variable)는 실험의 표본공간으로부터 실수의 집합으로의 **함수**이다. 즉, 확률변수는 가능한 각각의 결과에 실수를 할당한다.

**비고**: 확률변수는 하나의 함수일 뿐이며, 변수도 아니고 임의로 정해지는 것도 아니다.

### 예제 10: 동전 3번 던지기 (Rosen 예제 10)

> X(t)를 동전을 3번 던져 나온 결과 t에 대한 함수값이 앞면의 개수인 확률변수라 하면:

| 결과 t | X(t) |
|--------|------|
| HHH | 3 |
| HHT, HTH, THH | 2 |
| TTH, THT, HTT | 1 |
| TTT | 0 |

```lean
-- 확률변수: 결과 → 값
-- Lean에서는 단순히 함수로 표현한다
def coinFlip3 : List Bool → ℕ := fun bits =>
  bits.count true

-- 예: [true, true, false] → 앞면 2번
example : coinFlip3 [true, true, false] = 2 := by native_decide
```

### 정의 7: 확률변수의 분포

> 표본공간 S에서 확률변수 X의 **분포**(distribution)는 모든 r ∈ X(S)에 대하여 X의 값이 r일 확률 p(X = r)인 순서쌍 (r, p(X = r))의 집합이다.

예제 10의 확률변수 X(t)의 분포:
- P(X = 3) = 1/8, P(X = 2) = 3/8, P(X = 1) = 3/8, P(X = 0) = 1/8

```lean
-- 분포 확인: 합이 1
example : (1:ℚ)/8 + 3/8 + 3/8 + 1/8 = 1 := by norm_num
```

---

## 📖 10B.7 생일문제

### 예제 13: 생일문제 (Rosen 예제 13)

> 최소 몇 명이 있으면 그중에서 적어도 두 명의 생일이 같을 확률이 1/2보다 커지는가?

이 문제는 여사건을 이용하면 풀 수 있다.

**핵심 아이디어**: 
- "적어도 두 명의 생일이 같다" 의 여사건 = "**모든 사람의 생일이 서로 다르다**"
- 모든 생일이 다를 확률 pₙ을 구한 후, 1 - pₙ > 1/2가 되는 최소 n을 찾는다

### 생일이 모두 다를 확률

1년이 366일(윤년 포함)이라 가정하자. n명의 사람이 있을 때:
- 첫 번째 사람: 아무 날이나 → 366/366
- 두 번째 사람: 첫 번째와 다른 날 → 365/366
- 세 번째 사람: 앞 두 사람과 다른 날 → 364/366
- …
- n번째 사람: (367-n)/366

모든 생일이 다를 확률:

pₙ = (365/366) × (364/366) × … × ((367-n)/366)

적어도 두 명의 생일이 같을 확률: **1 - pₙ**

### 결과

계산해 보면:
- n = 22: 1 - p₂₂ ≈ 0.475 (아직 1/2 미만)
- n = 23: 1 - p₂₃ ≈ 0.506 (1/2 초과!)

따라서 **23명**이면 적어도 두 명의 생일이 같을 확률이 1/2보다 커진다.

> 💡 대부분의 사람들은 365명 가까이 필요하다고 생각하지만, 실제로는 **23명**이면 충분하다! 이것이 생일문제가 유명한 이유이다.

```lean
-- 생일문제: 23명일 때 확률 계산
-- 모든 생일이 다를 확률 = 365/366 * 364/366 * ... * 344/366
-- 이것을 직접 계산하기보다, 핵심 구조만 확인하자

-- n명에서 모든 생일이 다를 확률의 분모는 366^n
-- n = 2일 때: p₂ = 365/366
example : (365:ℚ)/366 < 1 := by norm_num

-- n = 23이면 50%를 넘는다는 사실
-- 23명은 매우 적은 수이지만 확률은 50%를 넘는다!
-- 이것은 "쌍"의 수가 C(23,2) = 253으로 상당히 크기 때문이다
example : Nat.choose 23 2 = 253 := by native_decide
```

---

## 📖 10B.8 쌍으로 독립과 서로 독립

3개 이상의 사건에 대해서는 두 가지 유형의 독립을 구분해야 한다.

### 정의 5: 쌍으로 독립 vs 서로 독립

> 사건 E₁, E₂, …, Eₙ이 **쌍으로 독립**(pairwise independent)인 필요충분조건은 모든 정수의 쌍 (i, j)에 대해:
>
> p(Eᵢ ∩ Eⱼ) = p(Eᵢ) · p(Eⱼ)

> 사건 E₁, E₂, …, Eₙ이 **서로 독립**(mutually independent)이면 위 조건에 더하여, 3개, 4개, …, n개씩의 모든 교집합에 대해서도:
>
> p(Eᵢ₁ ∩ Eᵢ₂ ∩ … ∩ Eᵢₘ) = p(Eᵢ₁) · p(Eᵢ₂) · … · p(Eᵢₘ)

> ⚠️ 쌍으로 독립이라고 해서 반드시 서로 독립인 것은 **아니다**! 역은 성립한다(서로 독립이면 쌍으로 독립).

---

## ✏️ 10B.9 연습문제 — 설명형

### 연습 1: 확률분포 확인

> 앞면이 나올 가능성이 뒷면보다 3배 많은 특별한 동전을 던졌을 때, 앞면이 나올 확률과 뒷면이 나올 확률을 각각 구하라.

```lean
-- 연습 1: p(H) = 3p(T), p(H) + p(T) = 1
-- 4p(T) = 1 → p(T) = 1/4, p(H) = 3/4
example : (3:ℚ)/4 + 1/4 = 1 := by norm_num
```

<details>
<summary>📝 풀이 보기</summary>

p(H) = 3·p(T)이고 p(H) + p(T) = 1이므로 4·p(T) = 1, p(T) = 1/4, p(H) = 3/4.

```lean
example : (3:ℚ)/4 + 1/4 = 1 := by norm_num
```

</details>

---

### 연습 2: 특별한 주사위

> 2가 나올 가능성과 4가 나올 가능성이 서로 같고, 다른 숫자보다 3배 많은 특별한 주사위를 굴렸을 때, 각 숫자가 나올 확률은?

```lean
-- 연습 2
-- p(2) = p(4) = 3x, 나머지 = x (4개)
-- 2(3x) + 4x = 10x = 1 → x = 1/10
-- p(2) = p(4) = 3/10, 나머지 = 1/10
example : 2 * (3:ℚ)/10 + 4 * (1:ℚ)/10 = 1 := by norm_num
```

<details>
<summary>📝 풀이 보기</summary>

p(2) = p(4) = 3/10, p(1) = p(3) = p(5) = p(6) = 1/10. 합: 3/10 + 1/10 + 1/10 + 3/10 + 1/10 + 1/10 = 10/10 = 1.

```lean
example : (3:ℚ)/10 + 1/10 + 1/10 + 3/10 + 1/10 + 1/10 = 1 := by norm_num
```

</details>

---

## ✏️ 10B.10 연습문제 — 괄호 채우기

### 연습 3: 조건부확률

> 자녀가 둘인 가정에서 첫째가 딸인 사건을 F, 적어도 한 명이 아들인 사건을 E라 하자. p(E | F)는?

**힌트**: F = {GB, GG}, E = {BB, BG, GB}, E ∩ F = {GB}

```lean
-- 연습 3: p(E|F) = p(E∩F)/p(F)
-- p(E∩F) = 1/4, p(F) = 2/4 = 1/2
example : ((1:ℚ)/4) / (/-여기를 채우세요-/) = 1/2 := by norm_num
```

<details>
<summary>📝 풀이 보기</summary>

p(F) = 2/4 = 1/2, p(E∩F) = 1/4. p(E|F) = (1/4)/(1/2) = 1/2.

```lean
example : ((1:ℚ)/4) / ((1:ℚ)/2) = 1/2 := by norm_num
```

</details>

---

### 연습 4: 이항분포

> 공정한 동전을 5번 던져서 앞면이 정확히 3번 나올 확률은?

**힌트**: C(5,3) · (1/2)³ · (1/2)² = C(5,3)/2⁵

```lean
-- 연습 4
-- C(5,3) = 10
example : Nat.choose 5 3 = /-여기를 채우세요-/ := by native_decide

-- 확률 = 10/32 = 5/16
example : (/-여기를 채우세요-/ : ℚ) / 32 = 5 / 16 := by norm_num
```

<details>
<summary>📝 풀이 보기</summary>

C(5,3) = 10. 확률 = 10/32 = 5/16.

```lean
example : Nat.choose 5 3 = 10 := by native_decide
example : (10 : ℚ) / 32 = 5 / 16 := by norm_num
```

</details>

---

### 연습 5: 독립성 판정

> 공정한 동전을 2번 던진다. E₁ = "첫 번째 뒷면", E₂ = "두 번째 뒷면". E₁과 E₂는 독립사건인가?

**힌트**: 표본공간 = {HH, HT, TH, TT}

```lean
-- 연습 5
-- p(E₁) = 2/4 = 1/2, p(E₂) = 2/4 = 1/2
-- E₁ ∩ E₂ = {TT} → p(E₁∩E₂) = 1/4
-- 독립? p(E₁)·p(E₂) = 1/2 · 1/2 = 1/4 = p(E₁∩E₂) ✓
example : (1:ℚ)/2 * (1:ℚ)/2 = /-여기를 채우세요-/ := by norm_num
```

<details>
<summary>📝 풀이 보기</summary>

p(E₁) · p(E₂) = 1/4 = p(E₁ ∩ E₂). 독립이다.

```lean
example : (1:ℚ)/2 * (1:ℚ)/2 = (1:ℚ)/4 := by norm_num
```

</details>

---

## ✏️ 10B.11 연습문제 — sorry 채우기

### 연습 6: 확률분포 합 = 1

> 다음을 증명하라: p(1) = p(2) = … = p(6) = 1/6인 공정한 주사위의 확률분포에서 모든 확률의 합은 1이다.

```lean
-- 연습 6
example : (1:ℚ)/6 + 1/6 + 1/6 + 1/6 + 1/6 + 1/6 = 1 := by
  sorry
```

<details>
<summary>📝 풀이 보기</summary>

```lean
example : (1:ℚ)/6 + 1/6 + 1/6 + 1/6 + 1/6 + 1/6 = 1 := by norm_num
```

</details>

---

### 연습 7: 이항분포 — 불량률

> 어떤 공장에서 제품이 불량일 확률이 0.1이다. 10개의 제품 중 정확히 2개가 불량일 확률은? (각 제품의 불량 여부는 독립이다.)

```lean
-- 연습 7: C(10,2) · (0.1)^2 · (0.9)^8
-- C(10, 2) = 45
example : Nat.choose 10 2 = 45 := by sorry

-- (1/10)^2 = 1/100
example : ((1:ℚ)/10)^2 = 1/100 := by sorry

-- (9/10)^8 = 43046721/100000000
example : ((9:ℚ)/10)^8 = 43046721/100000000 := by sorry

-- 최종: 45 * 1/100 * 43046721/100000000
-- = 45 * 43046721 / 10000000000
-- = 1937102445 / 10000000000
```

<details>
<summary>📝 풀이 보기</summary>

```lean
example : Nat.choose 10 2 = 45 := by native_decide
example : ((1:ℚ)/10)^2 = 1/100 := by norm_num
example : ((9:ℚ)/10)^8 = 43046721/100000000 := by norm_num
```

</details>

---

### 연습 8: 생일문제 — 쌍의 수

> 23명에서 만들 수 있는 "사람 쌍"의 수가 253임을 보여라.

```lean
-- 연습 8: C(23, 2)
example : Nat.choose 23 2 = 253 := by
  sorry
```

<details>
<summary>📝 풀이 보기</summary>

```lean
example : Nat.choose 23 2 = 253 := by native_decide
```

</details>

---

### 연습 9: 여사건 — 비트열

> 5개의 비트로 구성된 비트열에서 모든 비트가 같지는 않을(즉, 00000이나 11111이 아닐) 확률은?

```lean
-- 연습 9
-- 표본공간: 2^5 = 32
-- 여사건(모두 같은 비트): 00000, 11111 = 2가지
-- p = 1 - 2/32 = 30/32 = 15/16
example : (2:ℕ) ^ 5 = 32 := by sorry
example : 1 - (2:ℚ)/32 = 15/16 := by sorry
```

<details>
<summary>📝 풀이 보기</summary>

```lean
example : (2:ℕ) ^ 5 = 32 := by norm_num
example : 1 - (2:ℚ)/32 = 15/16 := by norm_num
```

</details>

---

### 연습 10: 포커 — 풀 하우스

> 포커에서 카드 5장 중 3장의 숫자가 같고 나머지 2장의 숫자가 같은 경우(풀 하우스)가 나올 확률은?

**힌트**: 
- 3장 같은 숫자 고르기: C(13,1) × C(4,3) = 13 × 4 = 52
- 2장 같은 숫자 고르기: C(12,1) × C(4,2) = 12 × 6 = 72
- 전체: C(52,5) = 2,598,960
- 경우의 수: 52 × 72 = 3744

```lean
-- 연습 10: 풀 하우스
example : 13 * 4 * 12 * 6 = 3744 := by sorry
example : Nat.choose 52 5 = 2598960 := by sorry
example : (3744 : ℚ) / 2598960 = 6 / 4165 := by sorry
```

<details>
<summary>📝 풀이 보기</summary>

```lean
example : 13 * 4 * 12 * 6 = 3744 := by norm_num
example : Nat.choose 52 5 = 2598960 := by native_decide
example : (3744 : ℚ) / 2598960 = 6 / 4165 := by norm_num
```

</details>

---

### 연습 11: 몬테 칼로 — 칩 검사

> PC 제조업체가 칩 66개를 검사하여 정상인 칩만 나오면 "정상"으로 판단한다. 불량률이 0.1일 때, 불량 칩이 있는 세트를 "정상"으로 잘못 판단할 확률은?

**힌트**: 각 칩이 정상일 확률 = 0.9. 66개 모두 정상일 확률 = 0.9⁶⁶

```lean
-- 연습 11
-- 0.9^66 ≈ 0.001, 즉 약 1/1000
-- 정확한 값: (9/10)^66
-- 오류 확률 = 0.9^66 < 0.001
-- 이는 "모든 칩이 정상" 일 확률이므로, 실제로 불량이 있는데도 통과할 확률이다
```

<details>
<summary>📝 풀이 보기</summary>

불량 칩이 있는 세트에서 검사한 66개가 모두 정상일 확률이 "잘못 판단" 확률이다. 각 칩을 검사할 때 정상인 칩이 나올 확률은 1 - 0.1 = 0.9이고, 66개가 모두 정상 → 0.9⁶⁶ ≈ 0.00099... < 1/1000.

</details>

---

### 연습 12: 종합 — calc로 이항분포

> 앞면이 나올 확률이 1/4인 동전을 4번 던져 앞면이 정확히 2번 나올 확률을 calc로 계산하라.

```lean
-- 연습 12: C(4,2) · (1/4)^2 · (3/4)^2
example : (Nat.choose 4 2 : ℚ) * ((1:ℚ)/4)^2 * ((3:ℚ)/4)^2 = 27/128 := by
  sorry
```

<details>
<summary>📝 풀이 보기</summary>

C(4,2) = 6. (1/4)² = 1/16. (3/4)² = 9/16. 6 × 1/16 × 9/16 = 54/256 = 27/128.

```lean
example : (Nat.choose 4 2 : ℚ) * ((1:ℚ)/4)^2 * ((3:ℚ)/4)^2 = 27/128 := by
  native_decide
```

또는 calc로:

```lean
example : (Nat.choose 4 2 : ℚ) * ((1:ℚ)/4)^2 * ((3:ℚ)/4)^2 = 27/128 := by
  have h1 : (Nat.choose 4 2 : ℚ) = 6 := by native_decide
  rw [h1]
  norm_num
```

</details>

---

## 📋 10B.12 핵심 정리 · 전술 요약

### 확률 공식 요약

| 공식 | 이름 |
|------|------|
| p(s) ≥ 0, ∑p(s) = 1 | 확률분포의 조건 |
| p(E) = ∑ₛ∈E p(s) | 사건의 확률 (정의 2) |
| p(Ē) = 1 - p(E) | 여사건의 확률 |
| p(E \| F) = p(E∩F)/p(F) | 조건부확률 (정의 3) |
| p(E∩F) = p(E)·p(F) ↔ 독립 | 독립사건 (정의 4) |
| C(n,k)·pᵏ·qⁿ⁻ᵏ | 이항분포 (정리 2) |

### 핵심 개념 비교

| 개념 | 설명 | Lean 표현 |
|------|------|---------|
| **확률분포**(probability distribution) | 각 결과에 확률 배정 | `α → ℚ` 함수 |
| **조건부확률**(conditional probability) | F 아래에서 E의 확률 | `p(E∩F)/p(F)` |
| **독립**(independent) | 서로 영향 없음 | `p(E∩F) = p(E)*p(F)` |
| **베르누이 시행**(Bernoulli trial) | 성공/실패 2가지 | `p + q = 1` |
| **이항분포**(binomial distribution) | n번 중 k번 성공 | `C(n,k)*p^k*q^(n-k)` |
| **확률변수**(random variable) | 결과 → 실수 함수 | `α → ℝ` 또는 `α → ℚ` |

---

## 🔜 다음 파트 예고

**Part 10-C**에서는 §7.3 **베이즈 정리**(Bayes' Theorem)를 다룬다:
- **전확률**(total probability)의 법칙
- **베이즈 정리** — 사전확률에서 사후확률로
- 의학 검사, 스팸 필터 등 응용

지금까지 배운 조건부확률을 뒤집어서, "결과를 보고 원인을 추론"하는 강력한 도구를 배우게 된다! 🔬
